<?xml version="1.0" encoding="utf-8" ?>
<c2eventsheet>
    <!--All the 'name' attributes are ignored by Construct 2 - they are there for readability only.-->
    <name>story events</name>
    <events>
        <include>gameplay stuff</include>
        <event-group description="" sid="863036200317594" title="AJAX request (Story)">
            <sub-events>
                <comment>Request the json once per day (it also triggers on the first start, for a New Game)</comment>
                <event-block sid="934392183261641">
                    <conditions>
                        <condition id="1" name="Is online" sid="846721641959368" type="Browser" />
                        <condition id="-7" inverted="1" name="Compare instance variable" sid="961771567704888" type="1storyJSON">
                            <param id="0" name="Instance variable">date</param>
                            <param id="1" name="Comparison">0</param>
                            <param id="2" name="Value">date.Date</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="1" name="Request project file" sid="390470154147478" type="AJAX">
                            <param id="0" name="Tag">&quot;story.json&quot;</param>
                            <param id="1" name="File">story.txt</param>
                        </action>
                        <action id="-10" name="Set value" sid="191775203687803" type="1storyJSON">
                            <param id="0" name="Instance variable">date</param>
                            <param id="1" name="Value">Date.Date</param>
                        </action>
                    </actions>
                </event-block>
                <comment>if the internet was down the first time you launched the game and the array is still empty, this will make sure you&apos;re quickly back on track by trying every 15 sec</comment>
                <event-block sid="484121997502294">
                    <conditions>
                        <condition id="70" name="Is Empty" sid="355472247943989" type="1storyJSON">
                            <param id="0" name="Reference point">0</param>
                            <param id="1" name="Key {n}"></param>
                        </condition>
                        <condition id="1" name="Is online" sid="354760909442845" type="Browser" />
                        <condition id="-6" name="Every X seconds" sid="598795862747915" type="System">
                            <param id="0" name="Interval (seconds)">15</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="1" name="Request project file" sid="476758344610784" type="AJAX">
                            <param id="0" name="Tag">&quot;story.json&quot;</param>
                            <param id="1" name="File">story.txt</param>
                        </action>
                    </actions>
                </event-block>
                <event-block sid="240571591470516">
                    <conditions>
                        <condition id="0" name="On completed" sid="751458063359856" type="AJAX">
                            <param id="0" name="Tag">&quot;story.json&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="60" name="LoadJSON" sid="669486008255952" type="1storyJSON">
                            <param id="0" name="JSON">AJAX.LastData</param>
                            <param id="1" name="Reference point">0</param>
                            <param id="2" name="Key {n}"></param>
                        </action>
                    </actions>
                </event-block>
                <event-block sid="556188440533073">
                    <conditions>
                        <condition id="1" name="On error" sid="253733252301136" type="AJAX">
                            <param id="0" name="Tag">&quot;story.json&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="14" name="Log" sid="765611765833961" type="Browser">
                            <param id="0" name="Type">1</param>
                            <param id="1" name="Message">&quot;Tried to retrieve silly messages but couldn&apos;t. Probably because internet connection is missing. Will try again later.&quot;</param>
                        </action>
                    </actions>
                </event-block>
                <event-block sid="267972802124585">
                    <conditions>
                        <condition id="200" name="On JSON Parse Error" sid="484748881712678" type="1storyJSON" />
                    </conditions>
                    <actions>
                        <action id="14" name="Log" sid="936555621740059" type="Browser">
                            <param id="0" name="Type">1</param>
                            <param id="1" name="Message">&quot;The Silly Message JSON is not formated properly.&quot;</param>
                        </action>
                    </actions>
                </event-block>
            </sub-events>
        </event-group>
        <event-block sid="575801268381648">
            <conditions>
                <condition id="70" inverted="1" name="Is Empty" sid="286974887218279" type="1storyJSON">
                    <param id="0" name="Reference point">0</param>
                    <param id="1" name="Key {n}"></param>
                </condition>
            </conditions>
            <actions />
            <sub-events>
                <event-block sid="209278545937750">
                    <conditions />
                    <actions>
                        <action id="-10" name="Set value" sid="200970776818759" type="1storyDisplay">
                            <param id="0" name="Instance variable">string</param>
                            <param id="1" name="Value">&quot;TEST TEST TEST&quot; &amp; newline &amp; 1storyJSON.Value(0, &quot;0&quot;, &quot;text&quot;)</param>
                        </action>
                    </actions>
                </event-block>
                <event-block sid="365026235180722">
                    <conditions>
                        <condition id="-7" name="Compare instance variable" sid="980892333958368" type="1storyJSON">
                            <param id="0" name="Instance variable">status</param>
                            <param id="1" name="Comparison">0</param>
                            <param id="2" name="Value">&quot;start&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="-10" name="Set value" sid="886052119075543" type="1storyStatus">
                            <param id="0" name="Instance variable">string</param>
                            <param id="1" name="Value">&quot;Welcome.&quot;</param>
                        </action>
                        <action id="-10" name="Set value" sid="141120008702266" type="1storyDisplay">
                            <param id="0" name="Instance variable">string</param>
                            <param id="1" name="Value">&quot;&quot;</param>
                        </action>
                        <action id="-10" name="Set value" sid="942534588317670" type="1storyJSON">
                            <param id="0" name="Instance variable">timer</param>
                            <param id="1" name="Value">0</param>
                        </action>
                    </actions>
                </event-block>
                <event-block sid="131905542415196">
                    <conditions>
                        <condition id="-7" name="Compare instance variable" sid="618968383824849" type="1storyJSON">
                            <param id="0" name="Instance variable">status</param>
                            <param id="1" name="Comparison">0</param>
                            <param id="2" name="Value">&quot;receiving&quot;</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <variable constant="0" name="deltaTime" sid="334433820832396" static="0" type="number">0</variable>
                        <event-block sid="182373823446677">
                            <conditions>
                                <condition id="0" name="On function" sid="352411805000581" type="Function">
                                    <param id="0" name="Name">&quot;time has passed&quot;</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-9" name="Set value" sid="347910322354869" type="System">
                                    <param id="0" name="Variable">deltaTime</param>
                                    <param id="1" name="Value">Function.Param(0)</param>
                                </action>
                                <action id="-11" name="Add to" sid="396610560432336" type="1storyJSON">
                                    <param id="0" name="Instance variable">timer</param>
                                    <param id="1" name="Value">deltaTime</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="764757488989010">
                            <conditions>
                                <condition id="-7" name="Compare instance variable" sid="670326981496766" type="1storyJSON">
                                    <param id="0" name="Instance variable">timer</param>
                                    <param id="1" name="Comparison">5</param>
                                    <param id="2" name="Value">1storyJSON.Value(0, 1storyJSON.maxStory, &quot;receive&quot;)</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-10" name="Set value" sid="824405483405464" type="1storyJSON">
                                    <param id="0" name="Instance variable">status</param>
                                    <param id="1" name="Value">&quot;received&quot;</param>
                                </action>
                            </actions>
                        </event-block>
                        <comment>UI</comment>
                        <event-block sid="572056362229419">
                            <conditions />
                            <actions />
                            <sub-events>
                                <comment>TODO : Je suis rendu ici! J&apos;essaye de mettre les boutons à disabled!</comment>
                                <event-block sid="182448178300984">
                                    <conditions>
                                        <condition id="-7" name="Compare instance variable" sid="300805570624549" type="lionTraderBtnBg">
                                            <param id="0" name="Instance variable">callback</param>
                                            <param id="1" name="Comparison">0</param>
                                            <param id="2" name="Value">0</param>
                                        </condition>
                                    </conditions>
                                    <actions />
                                </event-block>
                                <event-block sid="853710570701123">
                                    <conditions />
                                    <actions />
                                </event-block>
                            </sub-events>
                        </event-block>
                    </sub-events>
                </event-block>
                <event-block sid="935769181529758">
                    <conditions>
                        <condition id="-7" name="Compare instance variable" sid="893420544463086" type="1storyJSON">
                            <param id="0" name="Instance variable">status</param>
                            <param id="1" name="Comparison">0</param>
                            <param id="2" name="Value">&quot;received&quot;</param>
                        </condition>
                    </conditions>
                    <actions />
                </event-block>
            </sub-events>
        </event-block>
        <event-block sid="730002022199091">
            <conditions>
                <condition id="-22" name="Else" sid="839609060969714" type="System" />
            </conditions>
            <actions />
            <sub-events>
                <comment>Error cases:</comment>
                <comment>When the JSON is empty</comment>
                <variable constant="0" name="message" sid="495177879787669" static="0" type="text"></variable>
                <event-block sid="903502869057935">
                    <conditions>
                        <condition id="1" inverted="1" name="Is online" sid="940911970697401" type="Browser" />
                    </conditions>
                    <actions>
                        <action id="-9" name="Set value" sid="906474883272367" type="System">
                            <param id="0" name="Variable">message</param>
                            <param id="1" name="Value">&quot;Please connect to the internet.&quot;</param>
                        </action>
                    </actions>
                </event-block>
                <event-block sid="483242330754878">
                    <conditions>
                        <condition id="1" name="Is online" sid="920182164966835" type="Browser" />
                    </conditions>
                    <actions>
                        <action id="-9" name="Set value" sid="872198148379374" type="System">
                            <param id="0" name="Variable">message</param>
                            <param id="1" name="Value">&quot;Connecting...&quot;</param>
                        </action>
                    </actions>
                </event-block>
                <event-block sid="467228071700467">
                    <conditions />
                    <actions>
                        <action id="-10" name="Set value" sid="279120405391745" type="1storyDisplay">
                            <param id="0" name="Instance variable">string</param>
                            <param id="1" name="Value">message</param>
                        </action>
                        <action id="-10" name="Set value" sid="260290988127625" type="1storyStatus">
                            <param id="0" name="Instance variable">string</param>
                            <param id="1" name="Value">message</param>
                        </action>
                    </actions>
                </event-block>
            </sub-events>
        </event-block>
        <event-block sid="817314785781340">
            <conditions>
                <condition id="0" name="On function" sid="986386813652536" type="Function">
                    <param id="0" name="Name">&quot;first launch&quot;</param>
                </condition>
            </conditions>
            <actions />
        </event-block>
        <event-block sid="282292504480689">
            <conditions>
                <condition id="0" name="On function" sid="101239259300537" type="Function">
                    <param id="0" name="Name">&quot;time has passed&quot;</param>
                </condition>
            </conditions>
            <actions />
            <sub-events>
                <variable constant="0" name="deltaTime" sid="177755735675471" static="0" type="number">0</variable>
                <event-block sid="308852134587734">
                    <conditions />
                    <actions>
                        <action id="-9" name="Set value" sid="628856131065457" type="System">
                            <param id="0" name="Variable">deltaTime</param>
                            <param id="1" name="Value">Function.Param(0)</param>
                        </action>
                    </actions>
                </event-block>
                <event-block sid="466886045074306">
                    <conditions />
                    <actions />
                </event-block>
            </sub-events>
        </event-block>
        <event-block sid="855821839646030">
            <conditions>
                <condition id="0" name="On function" sid="468278706853853" type="Function">
                    <param id="0" name="Name">&quot;story receive clicked&quot;</param>
                </condition>
            </conditions>
            <actions>
                <action id="14" name="Log" sid="959428479286106" type="Browser">
                    <param id="0" name="Type">0</param>
                    <param id="1" name="Message">&quot;receive&quot;</param>
                </action>
                <action id="-10" name="Set value" sid="459244211573671" type="1storyJSON">
                    <param id="0" name="Instance variable">status</param>
                    <param id="1" name="Value">&quot;receiving&quot;</param>
                </action>
            </actions>
        </event-block>
        <event-block sid="330906934254617">
            <conditions>
                <condition id="0" name="On function" sid="207155003671887" type="Function">
                    <param id="0" name="Name">&quot;story decode clicked&quot;</param>
                </condition>
            </conditions>
            <actions>
                <action id="14" name="Log" sid="738936045997006" type="Browser">
                    <param id="0" name="Type">0</param>
                    <param id="1" name="Message">&quot;decode&quot;</param>
                </action>
            </actions>
        </event-block>
    </events>
</c2eventsheet>
