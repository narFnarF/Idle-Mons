<?xml version="1.0" encoding="utf-8" ?>
<c2eventsheet>
    <!--All the 'name' attributes are ignored by Construct 2 - they are there for readability only.-->
    <name>traps events</name>
    <events>
        <include>global events</include>
        <include>gameplay stuff</include>
        <event-block sid="227827290332802">
            <conditions>
                <condition id="0" name="On function" sid="741191467400781" type="Function">
                    <param id="0" name="Name">&quot;time has passed&quot;</param>
                </condition>
            </conditions>
            <actions />
            <sub-events>
                <variable constant="0" name="deltaTime" sid="857004679723869" static="0" type="number">0</variable>
                <event-block sid="278529939378744">
                    <conditions />
                    <actions>
                        <action id="-9" name="Set value" sid="830996273618068" type="System">
                            <param id="0" name="Variable">deltaTime</param>
                            <param id="1" name="Value">Function.Param(0)</param>
                        </action>
                        <action disabled="1" id="14" name="Log" sid="772635217874528" type="Browser">
                            <param id="0" name="Type">0</param>
                            <param id="1" name="Message">&quot;deltaTime: &quot; &amp; deltaTime</param>
                        </action>
                    </actions>
                </event-block>
                <comment>Ignore absence of less than 10 sec</comment>
                <event-block sid="331503936648156">
                    <conditions>
                        <condition id="-14" name="Compare variable" sid="187078355772580" type="System">
                            <param id="0" name="Variable">deltaTime</param>
                            <param id="1" name="Comparison">4</param>
                            <param id="2" name="Value">10</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="0" name="Call function" sid="922472815563280" type="Function">
                            <param id="0" name="Name">&quot;traps .simulateTime&quot;</param>
                            <param id="1" name="Parameter {n}">deltaTime</param>
                        </action>
                    </actions>
                </event-block>
                <event-block sid="659748752420684">
                    <conditions>
                        <condition id="-22" name="Else" sid="542244244846677" type="System" />
                    </conditions>
                    <actions>
                        <action id="14" name="Log" sid="309947899400749" type="Browser">
                            <param id="0" name="Type">0</param>
                            <param id="1" name="Message">&quot;This absence wasn&apos;t long enough (less than 10 sec)&quot;</param>
                        </action>
                    </actions>
                </event-block>
            </sub-events>
        </event-block>
        <event-block sid="921284008469349">
            <conditions>
                <condition id="0" name="On function" sid="752542714840261" type="Function">
                    <param id="0" name="Name">&quot;traps .simulateTime&quot;</param>
                </condition>
            </conditions>
            <actions>
                <action id="14" name="Log" sid="580745178041100" type="Browser">
                    <param id="0" name="Type">0</param>
                    <param id="1" name="Message">&quot;Entering function: traps.simulateTime&quot;</param>
                </action>
            </actions>
            <sub-events>
                <variable constant="1" name="TIME_BLOCK_DURATION" sid="625836116514235" static="0" type="number">4</variable>
                <variable comment="time left" constant="0" name="tl" sid="384687047515406" static="0" type="number">0</variable>
                <event-block sid="194235794000556">
                    <conditions />
                    <actions>
                        <action id="-9" name="Set value" sid="127105190769506" type="System">
                            <param id="0" name="Variable">tl</param>
                            <param id="1" name="Value">Function.Param(0) / 60</param>
                        </action>
                    </actions>
                </event-block>
                <event-block sid="105680083456008">
                    <conditions>
                        <condition id="-23" name="While" sid="431170692293679" type="System" />
                        <condition id="-14" name="Compare variable" sid="970890296713422" type="System">
                            <param id="0" name="Variable">tl</param>
                            <param id="1" name="Comparison">4</param>
                            <param id="2" name="Value">0</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="14" name="Log" sid="246963863107308" type="Browser">
                            <param id="0" name="Type">0</param>
                            <param id="1" name="Message">&quot;!!!!!!!!!!!!!&quot;</param>
                        </action>
                        <action id="14" name="Log" sid="120114632393702" type="Browser">
                            <param id="0" name="Type">0</param>
                            <param id="1" name="Message">&quot;tl: &quot; &amp; tl</param>
                        </action>
                    </actions>
                    <sub-events>
                        <variable constant="0" name="thisBlock" sid="826294523788411" static="0" type="number">0</variable>
                        <comment>more than 1 block of time</comment>
                        <event-block sid="368434544033467">
                            <conditions>
                                <condition id="-14" name="Compare variable" sid="904825440162794" type="System">
                                    <param id="0" name="Variable">tl</param>
                                    <param id="1" name="Comparison">5</param>
                                    <param id="2" name="Value">TIME_BLOCK_DURATION</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-9" name="Set value" sid="679693996236491" type="System">
                                    <param id="0" name="Variable">thisBlock</param>
                                    <param id="1" name="Value">TIME_BLOCK_DURATION</param>
                                </action>
                                <action id="14" name="Log" sid="504956994230225" type="Browser">
                                    <param id="0" name="Type">0</param>
                                    <param id="1" name="Message">&quot;thisBlock: &quot; &amp; thisBlock</param>
                                </action>
                            </actions>
                        </event-block>
                        <comment>less than 1 block of time</comment>
                        <event-block sid="495657293212103">
                            <conditions>
                                <condition id="-22" name="Else" sid="135359276131536" type="System" />
                            </conditions>
                            <actions>
                                <action id="-9" name="Set value" sid="756060138351687" type="System">
                                    <param id="0" name="Variable">thisBlock</param>
                                    <param id="1" name="Value">tl</param>
                                </action>
                                <action id="14" name="Log" sid="566185711766322" type="Browser">
                                    <param id="0" name="Type">0</param>
                                    <param id="1" name="Message">&quot;thisBlock: &quot; &amp; thisBlock</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="856094115511851">
                            <conditions>
                                <condition id="-11" name="For Each" sid="851329983815427" type="System">
                                    <param id="0" name="Object">3trap</param>
                                </condition>
                            </conditions>
                            <actions />
                            <sub-events>
                                <comment>if there&apos;s a mon</comment>
                                <event-block sid="876157881656161">
                                    <conditions>
                                        <condition id="-7" name="Compare instance variable" sid="492012577566673" type="3trap">
                                            <param id="0" name="Instance variable">visitorId</param>
                                            <param id="1" name="Comparison">1</param>
                                            <param id="2" name="Value">-1</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="-12" name="Subtract from" sid="483501588285701" type="3trap">
                                            <param id="0" name="Instance variable">minutesRemaining</param>
                                            <param id="1" name="Value">thisBlock</param>
                                        </action>
                                    </actions>
                                    <sub-events>
                                        <comment>mon is leaving</comment>
                                        <comment>TODO: add the leaving mon+gift to the log</comment>
                                        <event-block sid="827542540895803">
                                            <conditions>
                                                <condition id="-7" name="Compare instance variable" sid="681129055259841" type="3trap">
                                                    <param id="0" name="Instance variable">minutesRemaining</param>
                                                    <param id="1" name="Comparison">3</param>
                                                    <param id="2" name="Value">0</param>
                                                </condition>
                                            </conditions>
                                            <actions>
                                                <action id="14" name="Log" sid="606537948298584" type="Browser">
                                                    <param id="0" name="Type">1</param>
                                                    <param id="1" name="Message">Function.Call(&quot;mons .name&quot;, 3trap.visitorId) &amp; &quot; left and gave &quot; &amp; Function.Call(&quot;mons .gift&quot;, 3trap.visitorId)</param>
                                                </action>
                                                <action id="0" name="Call function" sid="538787920604462" type="Function">
                                                    <param id="0" name="Name">&quot;mons .addToLog&quot;</param>
                                                    <param id="1" name="Parameter {n}">3trap.visitorId{###}Function.Call(&quot;mons .gift&quot;, 3trap.visitorId)</param>
                                                </action>
                                                <action id="-10" name="Set value" sid="866173730105609" type="3trap">
                                                    <param id="0" name="Instance variable">visitorId</param>
                                                    <param id="1" name="Value">-1</param>
                                                </action>
                                                <action id="-10" name="Set value" sid="332623101207398" type="3trap">
                                                    <param id="0" name="Instance variable">minutesRemaining</param>
                                                    <param id="1" name="Value">0</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                        <event-block sid="628786644588355">
                                            <conditions>
                                                <condition id="-22" name="Else" sid="534963581207652" type="System" />
                                            </conditions>
                                            <actions>
                                                <action id="14" name="Log" sid="498875887545357" type="Browser">
                                                    <param id="0" name="Type">0</param>
                                                    <param id="1" name="Message">Function.Call(&quot;mons .name&quot;, 3trap.visitorId) &amp; &quot; is staying.&quot;</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                    </sub-events>
                                </event-block>
                                <comment>Trap is empty</comment>
                                <event-block sid="995983242889859">
                                    <conditions>
                                        <condition id="-22" name="Else" sid="950957511835279" type="System" />
                                    </conditions>
                                    <actions />
                                    <sub-events>
                                        <variable constant="0" name="monCaptured" sid="987804508915747" static="0" type="number">-1</variable>
                                        <comment>check if new mon</comment>
                                        <event-block sid="260362210339063">
                                            <conditions />
                                            <actions>
                                                <action id="-9" name="Set value" sid="487873649318147" type="System">
                                                    <param id="0" name="Variable">monCaptured</param>
                                                    <param id="1" name="Value">Function.Call(&quot;mons .monTrapped&quot;)</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                        <event-block sid="839868961344069">
                                            <conditions>
                                                <condition id="-8" name="Compare two values" sid="175726364026577" type="System">
                                                    <param id="0" name="First value">monCaptured</param>
                                                    <param id="1" name="Comparison">1</param>
                                                    <param id="2" name="Second value">-1</param>
                                                </condition>
                                            </conditions>
                                            <actions>
                                                <action id="-10" name="Set value" sid="569476436039271" type="3trap">
                                                    <param id="0" name="Instance variable">visitorId</param>
                                                    <param id="1" name="Value">monCaptured</param>
                                                </action>
                                                <action id="-10" name="Set value" sid="373274409514661" type="3trap">
                                                    <param id="0" name="Instance variable">minutesRemaining</param>
                                                    <param id="1" name="Value">Function.Call(&quot;mons .duration&quot;, monCaptured)</param>
                                                </action>
                                                <action id="14" name="Log" sid="609621408870999" type="Browser">
                                                    <param id="0" name="Type">0</param>
                                                    <param id="1" name="Message">&quot;Trap &quot; &amp; 3trap.IID &amp; &quot; caught &quot; &amp; Function.Call(&quot;mons .name&quot;, monCaptured) &amp; &quot; who will stay for &quot; &amp; Function.Call(&quot;mons .duration&quot;, monCaptured) &amp; &quot; minutes.&quot;</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                        <event-block sid="559431760191955">
                                            <conditions>
                                                <condition id="-22" name="Else" sid="803717364009766" type="System" />
                                            </conditions>
                                            <actions>
                                                <action id="14" name="Log" sid="950446423349282" type="Browser">
                                                    <param id="0" name="Type">0</param>
                                                    <param id="1" name="Message">&quot;Trap &quot; &amp; 3trap.IID &amp; &quot; caught nothing.&quot;</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                    </sub-events>
                                </event-block>
                            </sub-events>
                        </event-block>
                        <event-block sid="877471148579095">
                            <conditions />
                            <actions>
                                <action id="-11" name="Subtract from" sid="220089947912894" type="System">
                                    <param id="0" name="Variable">tl</param>
                                    <param id="1" name="Value">thisBlock</param>
                                </action>
                                <action disabled="1" id="-9" name="Set value" sid="509020828893869" type="System">
                                    <param id="0" name="Variable">tl</param>
                                    <param id="1" name="Value">max(0, tl-TIME_BLOCK_DURATION)</param>
                                </action>
                            </actions>
                            <sub-events>
                                <event-block disabled="1" sid="330771456466659">
                                    <conditions>
                                        <condition id="-14" name="Compare variable" sid="364935047246194" type="System">
                                            <param id="0" name="Variable">tl</param>
                                            <param id="1" name="Comparison">2</param>
                                            <param id="2" name="Value">0</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="-9" name="Set value" sid="909477132284120" type="System">
                                            <param id="0" name="Variable">tl</param>
                                            <param id="1" name="Value">0</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-block>
                    </sub-events>
                </event-block>
                <event-block sid="268463326671081">
                    <conditions />
                    <actions>
                        <action id="14" name="Log" sid="944621944543237" type="Browser">
                            <param id="0" name="Type">0</param>
                            <param id="1" name="Message">&quot;End of traps.simulateTime&quot;</param>
                        </action>
                    </actions>
                </event-block>
            </sub-events>
        </event-block>
        <event-group description="" sid="941902649631225" title="AJAX request (traps)">
            <sub-events>
                <comment>Request the json once per day (it also triggers on the first start, for a New Game)</comment>
                <event-block sid="474135525523124">
                    <conditions>
                        <condition id="1" name="Is online" sid="342637408275274" type="Browser" />
                        <condition id="-7" inverted="1" name="Compare instance variable" sid="217659171967679" type="3trapsJSON">
                            <param id="0" name="Instance variable">date</param>
                            <param id="1" name="Comparison">0</param>
                            <param id="2" name="Value">date.Date</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="1" name="Request project file" sid="983872325896409" type="AJAX">
                            <param id="0" name="Tag">&quot;mons.json&quot;</param>
                            <param id="1" name="File">mons.json</param>
                        </action>
                        <action id="-10" name="Set value" sid="570607403618910" type="3trapsJSON">
                            <param id="0" name="Instance variable">date</param>
                            <param id="1" name="Value">Date.Date</param>
                        </action>
                    </actions>
                </event-block>
                <comment>if the internet was down the first time you launched the game and the array is still empty, this will make sure you&apos;re quickly back on track by trying every 15 sec</comment>
                <event-block sid="850054465330936">
                    <conditions>
                        <condition id="70" name="Is Empty" sid="284789509293068" type="3trapsJSON">
                            <param id="0" name="Reference point">0</param>
                            <param id="1" name="Key {n}"></param>
                        </condition>
                        <condition id="1" name="Is online" sid="821078781737790" type="Browser" />
                        <condition id="-6" name="Every X seconds" sid="939480123943461" type="System">
                            <param id="0" name="Interval (seconds)">15</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="14" name="Log" sid="521256864770305" type="Browser">
                            <param id="0" name="Type">0</param>
                            <param id="1" name="Message">&quot;Trying to get again the traps JSON&quot;</param>
                        </action>
                        <action id="1" name="Request project file" sid="423401574443775" type="AJAX">
                            <param id="0" name="Tag">&quot;mons.json&quot;</param>
                            <param id="1" name="File">mons.json</param>
                        </action>
                    </actions>
                </event-block>
                <event-block sid="970818881138967">
                    <conditions>
                        <condition id="0" name="On completed" sid="727140558703871" type="AJAX">
                            <param id="0" name="Tag">&quot;mons.json&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="60" name="LoadJSON" sid="609327474889873" type="3trapsJSON">
                            <param id="0" name="JSON">AJAX.LastData</param>
                            <param id="1" name="Reference point">0</param>
                            <param id="2" name="Key {n}"></param>
                        </action>
                        <action id="0" name="Call function" sid="710814465641712" type="Function">
                            <param id="0" name="Name">&quot;dex .initiateDex&quot;</param>
                            <param id="1" name="Parameter {n}"></param>
                        </action>
                    </actions>
                </event-block>
                <event-block sid="690716924661973">
                    <conditions>
                        <condition id="1" name="On error" sid="404330999851662" type="AJAX">
                            <param id="0" name="Tag">&quot;mons.json&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="14" name="Log" sid="421414331579897" type="Browser">
                            <param id="0" name="Type">1</param>
                            <param id="1" name="Message">&quot;Tried to retrieve mons.json but couldn&apos;t. Probably because internet connection is missing. Will try again later.&quot;</param>
                        </action>
                    </actions>
                </event-block>
                <event-block sid="950896162275799">
                    <conditions>
                        <condition id="200" name="On JSON Parse Error" sid="582516010564090" type="3trapsJSON" />
                    </conditions>
                    <actions>
                        <action id="14" name="Log" sid="514927499061973" type="Browser">
                            <param id="0" name="Type">1</param>
                            <param id="1" name="Message">&quot;The mons.json is not formated properly.&quot;</param>
                        </action>
                    </actions>
                </event-block>
            </sub-events>
        </event-group>
        <event-group description="" sid="753817922202577" title="JSON functions (traps)">
            <sub-events>
                <event-block sid="123617965027594">
                    <conditions>
                        <condition id="0" name="On function" sid="298404752182894" type="Function">
                            <param id="0" name="Name">&quot;mons .count&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action disabled="1" id="14" name="Log" sid="206647750190367" type="Browser">
                            <param id="0" name="Type">0</param>
                            <param id="1" name="Message">&quot;function mons.count&quot;</param>
                        </action>
                        <action id="1" name="Set return value" sid="697573811616964" type="Function">
                            <param id="0" name="Value">3trapsJSON.Size(0, &quot;mons&quot;)</param>
                        </action>
                    </actions>
                </event-block>
                <event-block sid="477188139944862">
                    <conditions>
                        <condition id="0" name="On function" sid="659016455534248" type="Function">
                            <param id="0" name="Name">&quot;mons .name&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action disabled="1" id="14" name="Log" sid="596808656933670" type="Browser">
                            <param id="0" name="Type">0</param>
                            <param id="1" name="Message">&quot;function mons.name&quot;</param>
                        </action>
                    </actions>
                    <sub-events>
                        <variable constant="0" name="id" sid="100458996011092" static="0" type="number">0</variable>
                        <event-block sid="462651539278311">
                            <conditions />
                            <actions>
                                <action id="-9" name="Set value" sid="425932272756387" type="System">
                                    <param id="0" name="Variable">id</param>
                                    <param id="1" name="Value">Function.Param(0)</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="306108708430075">
                            <conditions />
                            <actions>
                                <action id="1" name="Set return value" sid="642553363933477" type="Function">
                                    <param id="0" name="Value">3trapsJSON.Value(0, &quot;mons&quot;, id, &quot;name&quot;)</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
                <event-block sid="821863189007117">
                    <conditions>
                        <condition id="0" name="On function" sid="969416389655742" type="Function">
                            <param id="0" name="Name">&quot;mons .duration&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action disabled="1" id="14" name="Log" sid="537808185672764" type="Browser">
                            <param id="0" name="Type">0</param>
                            <param id="1" name="Message">&quot;function mons.duration&quot;</param>
                        </action>
                    </actions>
                    <sub-events>
                        <variable constant="0" name="id" sid="457782863900060" static="0" type="number">0</variable>
                        <event-block sid="747312273509829">
                            <conditions />
                            <actions>
                                <action id="-9" name="Set value" sid="268123885150047" type="System">
                                    <param id="0" name="Variable">id</param>
                                    <param id="1" name="Value">Function.Param(0)</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="864828423975561">
                            <conditions />
                            <actions>
                                <action id="1" name="Set return value" sid="624335382913801" type="Function">
                                    <param id="0" name="Value">3trapsJSON.Value(0, &quot;mons&quot;, id, &quot;duration&quot;)</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
                <event-block sid="127761091134967">
                    <conditions>
                        <condition id="0" name="On function" sid="438217543000802" type="Function">
                            <param id="0" name="Name">&quot;mons .gift&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action disabled="1" id="14" name="Log" sid="963938234968675" type="Browser">
                            <param id="0" name="Type">0</param>
                            <param id="1" name="Message">&quot;function mons.gift&quot;</param>
                        </action>
                    </actions>
                    <sub-events>
                        <variable constant="0" name="id" sid="380853355695748" static="0" type="number">0</variable>
                        <event-block sid="318996005027027">
                            <conditions />
                            <actions>
                                <action id="-9" name="Set value" sid="436508474210798" type="System">
                                    <param id="0" name="Variable">id</param>
                                    <param id="1" name="Value">Function.Param(0)</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="288204887004785">
                            <conditions />
                            <actions>
                                <action id="1" name="Set return value" sid="531312288963452" type="Function">
                                    <param id="0" name="Value">3trapsJSON.Value(0, &quot;mons&quot;, id, &quot;gift&quot;)</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
                <event-block sid="831543791617884">
                    <conditions>
                        <condition id="0" name="On function" sid="573794856571839" type="Function">
                            <param id="0" name="Name">&quot;mons .monTrapped&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action disabled="1" id="14" name="Log" sid="414467370306111" type="Browser">
                            <param id="0" name="Type">0</param>
                            <param id="1" name="Message">&quot;function mons.monCaptured&quot;</param>
                        </action>
                    </actions>
                    <sub-events>
                        <comment>Calculate if a new mon is captured.</comment>
                        <comment>Returns the id of the mon captured, or -1 if no mon were captured.</comment>
                        <variable constant="0" name="monsterId" sid="752794100873998" static="0" type="number">0</variable>
                        <event-block sid="668507621416032">
                            <conditions>
                                <condition id="-8" name="Compare two values" sid="120950431300435" type="System">
                                    <param id="0" name="First value">random(5)</param>
                                    <param id="1" name="Comparison">3</param>
                                    <param id="2" name="Second value">1</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-9" name="Set value" sid="157691158738064" type="System">
                                    <param id="0" name="Variable">monsterId</param>
                                    <param id="1" name="Value">floor( random( Function.Call(&quot;mons .count&quot;) ) )</param>
                                </action>
                                <action id="1" name="Set return value" sid="814782047916874" type="Function">
                                    <param id="0" name="Value">monsterId</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="597898491845430">
                            <conditions>
                                <condition id="-22" name="Else" sid="798498993501664" type="System" />
                            </conditions>
                            <actions>
                                <action id="1" name="Set return value" sid="314618062184816" type="Function">
                                    <param id="0" name="Value">-1</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
            </sub-events>
        </event-group>
        <event-group description="" sid="567121584826885" title="pokedex functions">
            <sub-events>
                <event-block sid="691683130420115">
                    <conditions>
                        <condition id="0" name="On function" sid="101897455002414" type="Function">
                            <param id="0" name="Name">&quot;dex .count&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="1" name="Set return value" sid="472213109235614" type="Function">
                            <param id="0" name="Value">3dex.Size(0, &quot;pokedex&quot;)</param>
                        </action>
                    </actions>
                </event-block>
                <event-block sid="779215700955329">
                    <conditions>
                        <condition id="0" name="On function" sid="905309603963992" type="Function">
                            <param id="0" name="Name">&quot;dex .initiateDex&quot;</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <event-block sid="752963546902846">
                            <conditions>
                                <condition id="70" name="Is Empty" sid="442824718178616" type="3dex">
                                    <param id="0" name="Reference point">0</param>
                                    <param id="1" name="Key {n}"></param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="0" name="Set New Object" sid="924766987092095" type="3dex">
                                    <param id="0" name="Reference point">0</param>
                                    <param id="1" name="Key {n}"></param>
                                </action>
                                <action id="10" name="Set New Array" sid="604355993409428" type="3dex">
                                    <param id="0" name="Reference point">0</param>
                                    <param id="1" name="Key {n}">&quot;pokedex&quot;</param>
                                </action>
                            </actions>
                        </event-block>
                        <comment>If the pokedex doesn&apos;t include 1 entry for each mons in the official JSON</comment>
                        <event-block sid="339063246811357">
                            <conditions>
                                <condition id="-23" name="While" sid="455933065349651" type="System" />
                                <condition id="-8" name="Compare two values" sid="927750287603569" type="System">
                                    <param id="0" name="First value">Function.Call(&quot;mons .count&quot;)</param>
                                    <param id="1" name="Comparison">4</param>
                                    <param id="2" name="Second value">Function.Call(&quot;dex .count&quot;)</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action disabled="1" id="14" name="Log" sid="753607435771907" type="Browser">
                                    <param id="0" name="Type">0</param>
                                    <param id="1" name="Message">&quot;ici&quot;</param>
                                </action>
                                <action id="200" name="Set Current Path" sid="112003319117293" type="3dex">
                                    <param id="0" name="Reference point">0</param>
                                    <param id="1" name="Key {n}">&quot;pokedex&quot;</param>
                                </action>
                                <action id="0" name="Set New Object" sid="723505409257497" type="3dex">
                                    <param id="0" name="Reference point">1</param>
                                    <param id="1" name="Key {n}">Function.Call(&quot;dex .count&quot;)</param>
                                </action>
                                <action id="200" name="Set Current Path" sid="262643335983945" type="3dex">
                                    <param id="0" name="Reference point">0</param>
                                    <param id="1" name="Key {n}">&quot;pokedex&quot;{###}Function.Call(&quot;dex .count&quot;)-1</param>
                                </action>
                                <action id="30" name="Set Boolean" sid="345850003403642" type="3dex">
                                    <param id="0" name="value">1</param>
                                    <param id="1" name="Reference point">1</param>
                                    <param id="2" name="Key {n}">&quot;visited&quot;</param>
                                </action>
                                <action id="30" name="Set Boolean" sid="838293996677270" type="3dex">
                                    <param id="0" name="value">1</param>
                                    <param id="1" name="Reference point">1</param>
                                    <param id="2" name="Key {n}">&quot;seen&quot;</param>
                                </action>
                                <action id="20" name="Set Value" sid="806709911375903" type="3dex">
                                    <param id="0" name="Value">-1</param>
                                    <param id="1" name="Reference point">1</param>
                                    <param id="2" name="Key {n}">&quot;seen_timestamp&quot;</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
                <comment>TODO</comment>
                <event-block sid="785690843005112">
                    <conditions>
                        <condition id="0" name="On function" sid="417789067914248" type="Function">
                            <param id="0" name="Name">&quot;dex .visited&quot;</param>
                        </condition>
                    </conditions>
                    <actions />
                </event-block>
                <event-block sid="979703491321167">
                    <conditions>
                        <condition id="0" name="On function" sid="886979206347664" type="Function">
                            <param id="0" name="Name">&quot;dex .seen&quot;</param>
                        </condition>
                    </conditions>
                    <actions />
                </event-block>
            </sub-events>
        </event-group>
        <event-group description="" sid="799838731313010" title="debug (traps)">
            <sub-events>
                <event-block disabled="1" sid="332699366555795">
                    <conditions>
                        <condition id="-6" name="Every X seconds" sid="264565433427546" type="System">
                            <param id="0" name="Interval (seconds)">5</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="14" name="Log" sid="698703762127055" type="Browser">
                            <param id="0" name="Type">0</param>
                            <param id="1" name="Message">&quot;before&quot;</param>
                        </action>
                        <action disabled="1" id="14" name="Log" sid="208905483803146" type="Browser">
                            <param id="0" name="Type">0</param>
                            <param id="1" name="Message">&quot;debug: &quot; &amp; Function.Call(&quot;mons .addToLog&quot;, random(4), 2)</param>
                        </action>
                        <action disabled="1" id="14" name="Log" sid="578464219814689" type="Browser">
                            <param id="0" name="Type">0</param>
                            <param id="1" name="Message">3trapsJSON.Value(0, &quot;toto&quot;, &quot;titi&quot;)</param>
                        </action>
                        <action id="14" name="Log" sid="998090685355026" type="Browser">
                            <param id="0" name="Type">0</param>
                            <param id="1" name="Message">&quot;removing a node&quot;</param>
                        </action>
                        <action id="50" name="Delete" sid="743987538434026" type="3trapsJSON">
                            <param id="0" name="Reference point">0</param>
                            <param id="1" name="Key {n}">&quot;mons&quot;{###}0</param>
                        </action>
                        <action id="14" name="Log" sid="489380042055646" type="Browser">
                            <param id="0" name="Type">0</param>
                            <param id="1" name="Message">&quot;re-initialize the pokedex JSON&quot;</param>
                        </action>
                        <action id="0" name="Call function" sid="593521751542346" type="Function">
                            <param id="0" name="Name">&quot;dex .initiateDex&quot;</param>
                            <param id="1" name="Parameter {n}"></param>
                        </action>
                        <action id="14" name="Log" sid="670885946401365" type="Browser">
                            <param id="0" name="Type">0</param>
                            <param id="1" name="Message">&quot;after&quot;</param>
                        </action>
                    </actions>
                </event-block>
            </sub-events>
        </event-group>
        <event-group description="" sid="315831820789093" title="Traps">
            <sub-events>
                <event-block sid="697821194007688">
                    <conditions>
                        <condition id="-6" name="Every X seconds" sid="696162746251300" type="System">
                            <param id="0" name="Interval (seconds)">0.1</param>
                        </condition>
                        <condition id="-11" name="For Each" sid="929912707935820" type="System">
                            <param id="0" name="Object">3trap</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="0" name="Set text" sid="943839193267388" type="3trapsTxt">
                            <param id="0" name="Text">&quot;&quot;</param>
                        </action>
                    </actions>
                    <sub-events>
                        <event-block sid="736452608725933">
                            <conditions>
                                <condition id="-7" name="Compare instance variable" sid="636465651992512" type="3trap">
                                    <param id="0" name="Instance variable">visitorId</param>
                                    <param id="1" name="Comparison">1</param>
                                    <param id="2" name="Value">-1</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="0" name="Set text" sid="977291409766435" type="3trapsTxt">
                                    <param id="0" name="Text">Function.Call(&quot;mons .name&quot;, 3trap.visitorId)</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="340790824484576">
                            <conditions>
                                <condition id="-22" name="Else" sid="672513958344978" type="System" />
                            </conditions>
                            <actions>
                                <action id="0" name="Set text" sid="459426892854914" type="3trapsTxt">
                                    <param id="0" name="Text">&quot;---&quot;</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="329986872480882">
                            <conditions />
                            <actions>
                                <action id="1" name="Append text" sid="772207875819413" type="3trapsTxt">
                                    <param id="0" name="Text">newline &amp; &quot;time:&quot; &amp; round(3trap.minutesRemaining*60)</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
            </sub-events>
        </event-group>
        <event-group description="" sid="692558840707029" title="visitor log">
            <sub-events>
                <event-block sid="272295611573002">
                    <conditions>
                        <condition id="0" name="On function" sid="871642291389406" type="Function">
                            <param id="0" name="Name">&quot;mons .addToLog&quot;</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <variable constant="0" name="id" sid="634661851205561" static="0" type="number">0</variable>
                        <variable constant="0" name="gift" sid="868690269699964" static="0" type="number">0</variable>
                        <event-block sid="792136681793593">
                            <conditions />
                            <actions>
                                <action id="-9" name="Set value" sid="778245313283040" type="System">
                                    <param id="0" name="Variable">id</param>
                                    <param id="1" name="Value">Function.Param(0)</param>
                                </action>
                                <action id="-9" name="Set value" sid="658045070272759" type="System">
                                    <param id="0" name="Variable">gift</param>
                                    <param id="1" name="Value">Function.Param(1)</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="897997266406561">
                            <conditions />
                            <actions>
                                <action id="5" name="Push" sid="343395511228731" type="3captureLog">
                                    <param id="0" name="Where">0</param>
                                    <param id="1" name="Value">id</param>
                                    <param id="2" name="Axis">0</param>
                                </action>
                                <action id="3" name="Set at XY" sid="822950420966543" type="3captureLog">
                                    <param id="0" name="X">3captureLog.Width-1</param>
                                    <param id="1" name="Y">1</param>
                                    <param id="2" name="Value">gift</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
                <event-block any="1" sid="264576484155843">
                    <conditions>
                        <condition id="-6" name="Every X seconds" sid="674600533200818" type="System">
                            <param id="0" name="Interval (seconds)">0.5</param>
                        </condition>
                        <condition id="0" name="On function" sid="638380238563542" type="Function">
                            <param id="0" name="Name">&quot;log .updateLogTxt&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="0" name="Set text" sid="709532695972098" type="3captureLogTxt">
                            <param id="0" name="Text">&quot;Log:&quot; &amp; newline</param>
                        </action>
                    </actions>
                    <sub-events>
                        <variable constant="0" name="i" sid="499906681761096" static="0" type="number">0</variable>
                        <event-block sid="424424559130606">
                            <conditions>
                                <condition id="3" name="For each element" sid="316433907316426" type="3captureLog">
                                    <param id="0" name="Axes">2</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-9" name="Set value" sid="891514745513187" type="System">
                                    <param id="0" name="Variable">i</param>
                                    <param id="1" name="Value">3captureLog.CurValue</param>
                                </action>
                                <action id="1" name="Append text" sid="822992038147451" type="3captureLogTxt">
                                    <param id="0" name="Text">Function.Call(&quot;mons .name&quot;, i) &amp; &quot; left you &quot; &amp; Function.Call(&quot;mons .gift&quot;, i) &amp; newline</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
            </sub-events>
        </event-group>
        <event-group description="" sid="571402838961887" title="Pokedex">
            <sub-events>
                <comment>Fill the pokedex</comment>
                <event-block sid="323492783053990">
                    <conditions>
                        <condition id="-2" name="On start of layout" sid="548898391168714" type="System" />
                    </conditions>
                    <actions>
                        <action id="0" name="Call function" sid="624472023115446" type="Function">
                            <param id="0" name="Name">&quot;dex .initiateDex&quot;</param>
                            <param id="1" name="Parameter {n}"></param>
                        </action>
                    </actions>
                </event-block>
            </sub-events>
        </event-group>
    </events>
</c2eventsheet>
