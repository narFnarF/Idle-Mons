<?xml version="1.0" encoding="utf-8" ?>
<c2eventsheet>
    <!--All the 'name' attributes are ignored by Construct 2 - they are there for readability only.-->
    <name>eTraps</name>
    <events>
        <include>e Generic buttons</include>
        <include>eCurrency</include>
        <include>eInventory</include>
        <include>eMonsJSON</include>
        <include>eGlobal</include>
        <include>eGameplay stuff</include>
        <event-block sid="649720904779646">
            <conditions>
                <condition id="0" name="On function" sid="665948647074020" type="Function">
                    <param id="0" name="Name">&quot;first launch&quot;</param>
                </condition>
            </conditions>
            <actions />
        </event-block>
        <event-group description="" sid="675939317844959" title="Visual">
            <sub-events>
                <comment>Update visuals</comment>
                <event-block sid="697821194007688">
                    <conditions>
                        <condition id="-6" name="Every X seconds" sid="696162746251300" type="System">
                            <param id="0" name="Interval (seconds)">0.1</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="0" name="Call function" sid="680583904954545" type="Function">
                            <param id="0" name="Name">&quot;traps .updateVisual&quot;</param>
                            <param id="1" name="Parameter {n}"></param>
                        </action>
                    </actions>
                </event-block>
                <event-block sid="781154297030577">
                    <conditions>
                        <condition id="0" name="On function" sid="852169516758210" type="Function">
                            <param id="0" name="Name">&quot;traps .updateVisual&quot;</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <event-block sid="512153031611270">
                            <conditions>
                                <condition id="-11" name="For Each" sid="929912707935820" type="System">
                                    <param id="0" name="Object">3trap</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action disabled="1" id="0" name="Set text" sid="943839193267388" type="3trapsTxt">
                                    <param id="0" name="Text">&quot;&quot;</param>
                                </action>
                                <action id="-10" name="Set value" sid="213512157825687" type="3trapsTxt">
                                    <param id="0" name="Instance variable">theText</param>
                                    <param id="1" name="Value">&quot;&quot;</param>
                                </action>
                            </actions>
                            <sub-events>
                                <event-block sid="736452608725933">
                                    <conditions>
                                        <condition id="-7" name="Compare instance variable" sid="636465651992512" type="3trap">
                                            <param id="0" name="Instance variable">p_visitorId</param>
                                            <param id="1" name="Comparison">1</param>
                                            <param id="2" name="Value">-1</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action disabled="1" id="0" name="Set text" sid="977291409766435" type="3trapsTxt">
                                            <param id="0" name="Text">Function.Call(&quot;mons .name&quot;, 3trap.p_visitorId)</param>
                                        </action>
                                        <action id="-10" name="Set value" sid="383125026237853" type="3trapsTxt">
                                            <param id="0" name="Instance variable">theText</param>
                                            <param id="1" name="Value">Function.Call(&quot;mons .name&quot;, 3trap.p_visitorId)</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <event-block sid="340790824484576">
                                    <conditions>
                                        <condition id="-22" name="Else" sid="672513958344978" type="System" />
                                    </conditions>
                                    <actions>
                                        <action disabled="1" id="0" name="Set text" sid="459426892854914" type="3trapsTxt">
                                            <param id="0" name="Text">&quot;---&quot;</param>
                                        </action>
                                        <action id="-10" name="Set value" sid="193117559434076" type="3trapsTxt">
                                            <param id="0" name="Instance variable">theText</param>
                                            <param id="1" name="Value">&quot;---&quot;</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <event-block sid="329986872480882">
                                    <conditions />
                                    <actions>
                                        <action disabled="1" id="1" name="Append text" sid="772207875819413" type="3trapsTxt">
                                            <param id="0" name="Text">newline &amp; &quot;time:&quot; &amp; round(3trap.p_minutesRemaining*60)</param>
                                        </action>
                                        <action disabled="1" id="1" name="Append text" sid="384478765714674" type="3trapsTxt">
                                            <param id="0" name="Text">newline &amp; &quot;Bait: &quot; &amp; 3trap.p_baitType &amp; &quot; &quot; &amp; round(3trap.p_baitQuantity*60)</param>
                                        </action>
                                        <action id="-11" name="Add to" sid="434520236079587" type="3trapsTxt">
                                            <param id="0" name="Instance variable">theText</param>
                                            <param id="1" name="Value">newline &amp; &quot;time:&quot; &amp; round(3trap.p_minutesRemaining*60)</param>
                                        </action>
                                        <action id="-11" name="Add to" sid="405020879392279" type="3trapsTxt">
                                            <param id="0" name="Instance variable">theText</param>
                                            <param id="1" name="Value">newline &amp; &quot;Bait: &quot; &amp; 3trap.p_baitType &amp; &quot; &quot; &amp; round(3trap.p_baitQuantity*60)</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-block>
                    </sub-events>
                </event-block>
            </sub-events>
        </event-group>
        <event-group description="" sid="315831820789093" title="Traps functions">
            <sub-events>
                <event-block sid="831543791617884">
                    <conditions>
                        <condition id="0" name="On function" sid="573794856571839" type="Function">
                            <param id="0" name="Name">&quot;traps .testTrapCapture&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action disabled="1" id="14" name="Log" sid="414467370306111" type="Browser">
                            <param id="0" name="Type">0</param>
                            <param id="1" name="Message">&quot;function mons.monCaptured&quot;</param>
                        </action>
                    </actions>
                    <sub-events>
                        <comment>Calculate if a new mon is captured.</comment>
                        <comment>Returns the id of the mon captured, or -1 if no mon were captured.</comment>
                        <variable constant="0" name="monsterId" sid="752794100873998" static="0" type="number">0</variable>
                        <event-block sid="668507621416032">
                            <conditions>
                                <condition id="-8" name="Compare two values" sid="120950431300435" type="System">
                                    <param id="0" name="First value">random(5)</param>
                                    <param id="1" name="Comparison">3</param>
                                    <param id="2" name="Second value">1</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-9" name="Set value" sid="157691158738064" type="System">
                                    <param id="0" name="Variable">monsterId</param>
                                    <param id="1" name="Value">floor( random( Function.Call(&quot;mons .count&quot;) ) )</param>
                                </action>
                                <action id="1" name="Set return value" sid="814782047916874" type="Function">
                                    <param id="0" name="Value">monsterId</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="597898491845430">
                            <conditions>
                                <condition id="-22" name="Else" sid="798498993501664" type="System" />
                            </conditions>
                            <actions>
                                <action id="1" name="Set return value" sid="314618062184816" type="Function">
                                    <param id="0" name="Value">-1</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
                <event-block sid="227827290332802">
                    <conditions>
                        <condition id="0" name="On function" sid="741191467400781" type="Function">
                            <param id="0" name="Name">&quot;time has passed&quot;</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <variable constant="0" name="deltaTime" sid="857004679723869" static="0" type="number">0</variable>
                        <event-block sid="278529939378744">
                            <conditions />
                            <actions>
                                <action id="-9" name="Set value" sid="830996273618068" type="System">
                                    <param id="0" name="Variable">deltaTime</param>
                                    <param id="1" name="Value">Function.Param(0)</param>
                                </action>
                                <action disabled="1" id="14" name="Log" sid="772635217874528" type="Browser">
                                    <param id="0" name="Type">0</param>
                                    <param id="1" name="Message">&quot;deltaTime: &quot; &amp; deltaTime</param>
                                </action>
                            </actions>
                        </event-block>
                        <comment>Ignore absence of less than 10 sec</comment>
                        <event-block sid="331503936648156">
                            <conditions>
                                <condition id="-14" name="Compare variable" sid="187078355772580" type="System">
                                    <param id="0" name="Variable">deltaTime</param>
                                    <param id="1" name="Comparison">4</param>
                                    <param id="2" name="Value">10</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="0" name="Call function" sid="922472815563280" type="Function">
                                    <param id="0" name="Name">&quot;traps .simulateTime&quot;</param>
                                    <param id="1" name="Parameter {n}">deltaTime</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="659748752420684">
                            <conditions>
                                <condition id="-22" name="Else" sid="542244244846677" type="System" />
                            </conditions>
                            <actions>
                                <action disabled="1" id="14" name="Log" sid="309947899400749" type="Browser">
                                    <param id="0" name="Type">0</param>
                                    <param id="1" name="Message">&quot;This absence wasn&apos;t long enough (less than 10 sec)&quot;</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
                <event-block sid="921284008469349">
                    <conditions>
                        <condition id="0" name="On function" sid="752542714840261" type="Function">
                            <param id="0" name="Name">&quot;traps .simulateTime&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="14" name="Log" sid="580745178041100" type="Browser">
                            <param id="0" name="Type">0</param>
                            <param id="1" name="Message">&quot;Entering function: traps.simulateTime&quot;</param>
                        </action>
                    </actions>
                    <sub-events>
                        <variable constant="1" name="TIME_BLOCK_DURATION" sid="625836116514235" static="0" type="number">4</variable>
                        <variable comment="time left" constant="0" name="tl" sid="384687047515406" static="0" type="number">0</variable>
                        <event-block sid="194235794000556">
                            <conditions />
                            <actions>
                                <action id="-9" name="Set value" sid="127105190769506" type="System">
                                    <param id="0" name="Variable">tl</param>
                                    <param id="1" name="Value">Function.Param(0) / 60</param>
                                </action>
                            </actions>
                        </event-block>
                        <comment>Repeat for each block of time, the recap what heppened while the game was closed</comment>
                        <event-block sid="105680083456008">
                            <conditions>
                                <condition id="-23" name="While" sid="431170692293679" type="System" />
                                <condition id="-14" name="Compare variable" sid="970890296713422" type="System">
                                    <param id="0" name="Variable">tl</param>
                                    <param id="1" name="Comparison">4</param>
                                    <param id="2" name="Value">0</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="14" name="Log" sid="246963863107308" type="Browser">
                                    <param id="0" name="Type">0</param>
                                    <param id="1" name="Message">&quot;!!!!!!!!!!!!!&quot;</param>
                                </action>
                                <action id="14" name="Log" sid="120114632393702" type="Browser">
                                    <param id="0" name="Type">0</param>
                                    <param id="1" name="Message">&quot;tl: &quot; &amp; tl</param>
                                </action>
                            </actions>
                            <sub-events>
                                <variable constant="0" name="thisBlock" sid="826294523788411" static="0" type="number">0</variable>
                                <comment>more than 1 block of time</comment>
                                <event-block sid="368434544033467">
                                    <conditions>
                                        <condition id="-14" name="Compare variable" sid="904825440162794" type="System">
                                            <param id="0" name="Variable">tl</param>
                                            <param id="1" name="Comparison">5</param>
                                            <param id="2" name="Value">TIME_BLOCK_DURATION</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="-9" name="Set value" sid="679693996236491" type="System">
                                            <param id="0" name="Variable">thisBlock</param>
                                            <param id="1" name="Value">TIME_BLOCK_DURATION</param>
                                        </action>
                                        <action id="14" name="Log" sid="504956994230225" type="Browser">
                                            <param id="0" name="Type">0</param>
                                            <param id="1" name="Message">&quot;thisBlock: &quot; &amp; thisBlock</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <comment>less than 1 block of time</comment>
                                <event-block sid="495657293212103">
                                    <conditions>
                                        <condition id="-22" name="Else" sid="135359276131536" type="System" />
                                    </conditions>
                                    <actions>
                                        <action id="-9" name="Set value" sid="756060138351687" type="System">
                                            <param id="0" name="Variable">thisBlock</param>
                                            <param id="1" name="Value">tl</param>
                                        </action>
                                        <action id="14" name="Log" sid="566185711766322" type="Browser">
                                            <param id="0" name="Type">0</param>
                                            <param id="1" name="Message">&quot;thisBlock: &quot; &amp; thisBlock</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <comment>reduce bait quantity</comment>
                                <event-block sid="548494995530296">
                                    <conditions />
                                    <actions>
                                        <action id="-12" name="Subtract from" sid="826802893699378" type="3trap">
                                            <param id="0" name="Instance variable">p_baitQuantity</param>
                                            <param id="1" name="Value">thisBlock</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <event-block sid="856094115511851">
                                    <conditions>
                                        <condition id="-11" name="For Each" sid="851329983815427" type="System">
                                            <param id="0" name="Object">3trap</param>
                                        </condition>
                                    </conditions>
                                    <actions />
                                    <sub-events>
                                        <comment>if there&apos;s a mon</comment>
                                        <event-block sid="876157881656161">
                                            <conditions>
                                                <condition id="-7" name="Compare instance variable" sid="492012577566673" type="3trap">
                                                    <param id="0" name="Instance variable">p_visitorId</param>
                                                    <param id="1" name="Comparison">1</param>
                                                    <param id="2" name="Value">-1</param>
                                                </condition>
                                            </conditions>
                                            <actions>
                                                <action id="-12" name="Subtract from" sid="483501588285701" type="3trap">
                                                    <param id="0" name="Instance variable">p_minutesRemaining</param>
                                                    <param id="1" name="Value">thisBlock</param>
                                                </action>
                                            </actions>
                                            <sub-events>
                                                <comment>mon is leaving</comment>
                                                <event-block sid="827542540895803">
                                                    <conditions>
                                                        <condition id="-7" name="Compare instance variable" sid="681129055259841" type="3trap">
                                                            <param id="0" name="Instance variable">p_minutesRemaining</param>
                                                            <param id="1" name="Comparison">3</param>
                                                            <param id="2" name="Value">0</param>
                                                        </condition>
                                                    </conditions>
                                                    <actions>
                                                        <action id="14" name="Log" sid="606537948298584" type="Browser">
                                                            <param id="0" name="Type">0</param>
                                                            <param id="1" name="Message">Function.Call(&quot;mons .name&quot;, 3trap.p_visitorId) &amp; &quot; left and gave &quot; &amp; Function.Call(&quot;mons .gift&quot;, 3trap.p_visitorId)</param>
                                                        </action>
                                                        <action id="0" name="Call function" sid="538787920604462" type="Function">
                                                            <param id="0" name="Name">&quot;mons .addToLog&quot;</param>
                                                            <param id="1" name="Parameter {n}">3trap.p_visitorId{###}Function.Call(&quot;mons .gift&quot;, 3trap.p_visitorId)</param>
                                                        </action>
                                                        <action id="-10" name="Set value" sid="866173730105609" type="3trap">
                                                            <param id="0" name="Instance variable">p_visitorId</param>
                                                            <param id="1" name="Value">-1</param>
                                                        </action>
                                                        <action id="-10" name="Set value" sid="332623101207398" type="3trap">
                                                            <param id="0" name="Instance variable">p_minutesRemaining</param>
                                                            <param id="1" name="Value">0</param>
                                                        </action>
                                                    </actions>
                                                </event-block>
                                                <comment>Else (mon is staying)</comment>
                                                <event-block sid="628786644588355">
                                                    <conditions>
                                                        <condition id="-22" name="Else" sid="534963581207652" type="System" />
                                                    </conditions>
                                                    <actions>
                                                        <action id="14" name="Log" sid="498875887545357" type="Browser">
                                                            <param id="0" name="Type">0</param>
                                                            <param id="1" name="Message">&quot;Traps &quot; &amp; 3trap.id &amp; &quot;: &quot; &amp; Function.Call(&quot;mons .name&quot;, 3trap.p_visitorId) &amp; &quot; is staying.&quot;</param>
                                                        </action>
                                                    </actions>
                                                </event-block>
                                                <event-block sid="598667313284658">
                                                    <conditions>
                                                        <condition id="-7" name="Compare instance variable" sid="985863458505225" type="3trap">
                                                            <param id="0" name="Instance variable">p_baitQuantity</param>
                                                            <param id="1" name="Comparison">3</param>
                                                            <param id="2" name="Value">0</param>
                                                        </condition>
                                                    </conditions>
                                                    <actions>
                                                        <action id="14" name="Log" sid="490096655329138" type="Browser">
                                                            <param id="0" name="Type">0</param>
                                                            <param id="1" name="Message">&quot;Trap &quot; &amp; 3trap.id &amp; &quot; is empty of food.&quot;</param>
                                                        </action>
                                                    </actions>
                                                </event-block>
                                            </sub-events>
                                        </event-block>
                                        <comment>Else (Trap is empty) and there&apos;s still food</comment>
                                        <event-block sid="995983242889859">
                                            <conditions>
                                                <condition id="-22" name="Else" sid="950957511835279" type="System" />
                                                <condition id="-7" name="Compare instance variable" sid="988090990673384" type="3trap">
                                                    <param id="0" name="Instance variable">p_baitQuantity</param>
                                                    <param id="1" name="Comparison">4</param>
                                                    <param id="2" name="Value">0</param>
                                                </condition>
                                            </conditions>
                                            <actions />
                                            <sub-events>
                                                <variable constant="0" name="visitorId" sid="987804508915747" static="0" type="number">-1</variable>
                                                <comment>check if new mon</comment>
                                                <event-block sid="260362210339063">
                                                    <conditions />
                                                    <actions>
                                                        <action id="-9" name="Set value" sid="487873649318147" type="System">
                                                            <param id="0" name="Variable">visitorId</param>
                                                            <param id="1" name="Value">Function.Call(&quot;traps .testTrapCapture&quot;)</param>
                                                        </action>
                                                    </actions>
                                                </event-block>
                                                <event-block sid="839868961344069">
                                                    <conditions>
                                                        <condition id="-8" name="Compare two values" sid="175726364026577" type="System">
                                                            <param id="0" name="First value">visitorId</param>
                                                            <param id="1" name="Comparison">1</param>
                                                            <param id="2" name="Second value">-1</param>
                                                        </condition>
                                                    </conditions>
                                                    <actions>
                                                        <action id="-10" name="Set value" sid="569476436039271" type="3trap">
                                                            <param id="0" name="Instance variable">p_visitorId</param>
                                                            <param id="1" name="Value">visitorId</param>
                                                        </action>
                                                        <action id="-10" name="Set value" sid="373274409514661" type="3trap">
                                                            <param id="0" name="Instance variable">p_minutesRemaining</param>
                                                            <param id="1" name="Value">Function.Call(&quot;mons .duration&quot;, visitorId)</param>
                                                        </action>
                                                        <action id="0" name="Call function" sid="724326527950565" type="Function">
                                                            <param id="0" name="Name">&quot;dex .addVisited&quot;</param>
                                                            <param id="1" name="Parameter {n}">visitorId</param>
                                                        </action>
                                                        <action id="14" name="Log" sid="609621408870999" type="Browser">
                                                            <param id="0" name="Type">0</param>
                                                            <param id="1" name="Message">&quot;Trap &quot; &amp; 3trap.id &amp; &quot; has a visitor: &quot; &amp; Function.Call(&quot;mons .name&quot;, visitorId) &amp; &quot; who will stay for &quot; &amp; Function.Call(&quot;mons .duration&quot;, visitorId) &amp; &quot; minutes.&quot;</param>
                                                        </action>
                                                    </actions>
                                                </event-block>
                                                <event-block sid="559431760191955">
                                                    <conditions>
                                                        <condition id="-22" name="Else" sid="803717364009766" type="System" />
                                                    </conditions>
                                                    <actions>
                                                        <action id="14" name="Log" sid="950446423349282" type="Browser">
                                                            <param id="0" name="Type">0</param>
                                                            <param id="1" name="Message">&quot;Trap &quot; &amp; 3trap.id &amp; &quot; remains empty.&quot;</param>
                                                        </action>
                                                    </actions>
                                                </event-block>
                                            </sub-events>
                                        </event-block>
                                        <event-block sid="592238453175658">
                                            <conditions>
                                                <condition id="-22" name="Else" sid="782261450747238" type="System" />
                                            </conditions>
                                            <actions>
                                                <action id="14" name="Log" sid="689744780788651" type="Browser">
                                                    <param id="0" name="Type">0</param>
                                                    <param id="1" name="Message">&quot;Trap &quot; &amp; 3trap.id &amp; &quot; has no food.&quot;</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                    </sub-events>
                                </event-block>
                                <event-block sid="877471148579095">
                                    <conditions />
                                    <actions>
                                        <action id="-11" name="Subtract from" sid="220089947912894" type="System">
                                            <param id="0" name="Variable">tl</param>
                                            <param id="1" name="Value">thisBlock</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-block>
                        <event-block sid="268463326671081">
                            <conditions />
                            <actions>
                                <action id="14" name="Log" sid="944621944543237" type="Browser">
                                    <param id="0" name="Type">0</param>
                                    <param id="1" name="Message">&quot;End of traps.simulateTime&quot;</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
                <event-block sid="820981368276782">
                    <conditions>
                        <condition id="0" name="On function" sid="785065140914631" type="Function">
                            <param id="0" name="Name">&quot;traps .refillFood&quot;</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <variable constant="0" name="trapId" sid="281562525377815" static="0" type="number">0</variable>
                        <variable comment="in minutes" constant="0" name="quantity" sid="154451084190827" static="0" type="number">0</variable>
                        <variable constant="0" name="baitType" sid="284311459943960" static="0" type="text"></variable>
                        <event-block sid="677681344588778">
                            <conditions>
                                <condition id="-8" name="Compare two values" sid="496355861176838" type="System">
                                    <param id="0" name="First value">Function.ParamCount</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Second value">3</param>
                                </condition>
                                <condition id="-42" name="Is value type" sid="794942329087292" type="System">
                                    <param id="0" name="Value">Function.Param(0)</param>
                                    <param id="1" name="Type">0</param>
                                </condition>
                                <condition id="-42" name="Is value type" sid="648275543917650" type="System">
                                    <param id="0" name="Value">Function.Param(1)</param>
                                    <param id="1" name="Type">0</param>
                                </condition>
                                <condition id="-42" name="Is value type" sid="956372804898701" type="System">
                                    <param id="0" name="Value">Function.Param(2)</param>
                                    <param id="1" name="Type">1</param>
                                </condition>
                            </conditions>
                            <actions />
                            <sub-events>
                                <event-block sid="723739251456353">
                                    <conditions />
                                    <actions>
                                        <action id="-9" name="Set value" sid="658355673151947" type="System">
                                            <param id="0" name="Variable">trapId</param>
                                            <param id="1" name="Value">Function.Param(0)</param>
                                        </action>
                                        <action id="-9" name="Set value" sid="121722168712658" type="System">
                                            <param id="0" name="Variable">quantity</param>
                                            <param id="1" name="Value">Function.Param(1)</param>
                                        </action>
                                        <action id="-9" name="Set value" sid="681238273591655" type="System">
                                            <param id="0" name="Variable">baitType</param>
                                            <param id="1" name="Value">Function.Param(2)</param>
                                        </action>
                                        <action disabled="1" id="14" name="Log" sid="747482156233240" type="Browser">
                                            <param id="0" name="Type">0</param>
                                            <param id="1" name="Message">&quot;Traps &quot; &amp; trapId &amp; &quot; receives &quot; &amp; quantity &amp; &quot; &quot; &amp; baitType</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <event-block sid="278961060542448">
                                    <conditions>
                                        <condition id="-7" name="Compare instance variable" sid="545906359100966" type="3trap">
                                            <param id="0" name="Instance variable">id</param>
                                            <param id="1" name="Comparison">0</param>
                                            <param id="2" name="Value">trapId</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="-10" name="Set value" sid="761120510233358" type="3trap">
                                            <param id="0" name="Instance variable">p_baitQuantity</param>
                                            <param id="1" name="Value">quantity</param>
                                        </action>
                                        <action id="-10" name="Set value" sid="545974884667133" type="3trap">
                                            <param id="0" name="Instance variable">p_baitType</param>
                                            <param id="1" name="Value">baitType</param>
                                        </action>
                                        <action disabled="1" id="14" name="Log" sid="576704974076925" type="Browser">
                                            <param id="0" name="Type">0</param>
                                            <param id="1" name="Message">&quot;ici&quot;</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-block>
                        <event-block sid="920726107417984">
                            <conditions>
                                <condition id="-22" name="Else" sid="278292278530336" type="System" />
                            </conditions>
                            <actions>
                                <action id="14" name="Log" sid="829460799286490" type="Browser">
                                    <param id="0" name="Type">1</param>
                                    <param id="1" name="Message">&quot;Error in traps.refillFood: Incorrect parameters&quot;</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
            </sub-events>
        </event-group>
        <event-group description="" sid="356917688667266" title="Actions">
            <sub-events>
                <comment>Add monsters met in the pokedex</comment>
                <event-block sid="478294794711464">
                    <conditions>
                        <condition id="-6" name="Every X seconds" sid="533795553274215" type="System">
                            <param id="0" name="Interval (seconds)">0.5</param>
                        </condition>
                        <condition id="-7" name="Compare instance variable" sid="344507394873373" type="3trap">
                            <param id="0" name="Instance variable">p_visitorId</param>
                            <param id="1" name="Comparison">1</param>
                            <param id="2" name="Value">-1</param>
                        </condition>
                        <condition id="-11" name="For Each" sid="469041856076076" type="System">
                            <param id="0" name="Object">3trap</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="0" name="Call function" sid="869837286786859" type="Function">
                            <param id="0" name="Name">&quot;dex .addMet&quot;</param>
                            <param id="1" name="Parameter {n}">3trap.p_visitorId</param>
                        </action>
                    </actions>
                </event-block>
            </sub-events>
        </event-group>
        <event-group description="" sid="692558840707029" title="visitor log">
            <sub-events>
                <event-block sid="272295611573002">
                    <conditions>
                        <condition id="0" name="On function" sid="871642291389406" type="Function">
                            <param id="0" name="Name">&quot;mons .addToLog&quot;</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <variable constant="0" name="id" sid="634661851205561" static="0" type="number">0</variable>
                        <variable constant="0" name="gift" sid="868690269699964" static="0" type="number">0</variable>
                        <event-block sid="792136681793593">
                            <conditions />
                            <actions>
                                <action id="-9" name="Set value" sid="778245313283040" type="System">
                                    <param id="0" name="Variable">id</param>
                                    <param id="1" name="Value">Function.Param(0)</param>
                                </action>
                                <action id="-9" name="Set value" sid="658045070272759" type="System">
                                    <param id="0" name="Variable">gift</param>
                                    <param id="1" name="Value">Function.Param(1)</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="897997266406561">
                            <conditions />
                            <actions>
                                <action id="5" name="Push" sid="343395511228731" type="3captureLog">
                                    <param id="0" name="Where">0</param>
                                    <param id="1" name="Value">id</param>
                                    <param id="2" name="Axis">0</param>
                                </action>
                                <action id="3" name="Set at XY" sid="822950420966543" type="3captureLog">
                                    <param id="0" name="X">3captureLog.Width-1</param>
                                    <param id="1" name="Y">1</param>
                                    <param id="2" name="Value">gift</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
                <event-block sid="264576484155843">
                    <conditions>
                        <condition id="0" name="On function" sid="638380238563542" type="Function">
                            <param id="0" name="Name">&quot;log .updateLogTxt&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action disabled="1" id="0" name="Set text" sid="709532695972098" type="3captureLogTxt">
                            <param id="0" name="Text">&quot;Log:&quot; &amp; newline</param>
                        </action>
                        <action id="-10" name="Set value" sid="372542361620330" type="3captureLogTxt">
                            <param id="0" name="Instance variable">theText</param>
                            <param id="1" name="Value">&quot;Log:&quot; &amp; newline</param>
                        </action>
                    </actions>
                    <sub-events>
                        <variable constant="0" name="i" sid="499906681761096" static="0" type="number">0</variable>
                        <event-block sid="424424559130606">
                            <conditions>
                                <condition id="3" name="For each element" sid="316433907316426" type="3captureLog">
                                    <param id="0" name="Axes">2</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-9" name="Set value" sid="891514745513187" type="System">
                                    <param id="0" name="Variable">i</param>
                                    <param id="1" name="Value">3captureLog.CurValue</param>
                                </action>
                                <action disabled="1" id="1" name="Append text" sid="822992038147451" type="3captureLogTxt">
                                    <param id="0" name="Text">Function.Call(&quot;mons .name&quot;, i) &amp; &quot; left you &quot; &amp; Function.Call(&quot;mons .gift&quot;, i) &amp; newline</param>
                                </action>
                                <action id="-11" name="Add to" sid="542891008317631" type="3captureLogTxt">
                                    <param id="0" name="Instance variable">theText</param>
                                    <param id="1" name="Value">Function.Call(&quot;mons .name&quot;, i) &amp; &quot; left you &quot; &amp; Function.Call(&quot;mons .gift&quot;, i) &amp; newline</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
                <event-block sid="517520596421292">
                    <conditions>
                        <condition id="-6" name="Every X seconds" sid="674600533200818" type="System">
                            <param id="0" name="Interval (seconds)">1</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="0" name="Call function" sid="351789719503035" type="Function">
                            <param id="0" name="Name">&quot;log .updateLogTxt&quot;</param>
                            <param id="1" name="Parameter {n}"></param>
                        </action>
                    </actions>
                </event-block>
            </sub-events>
        </event-group>
        <event-group description="" sid="850163292607216" title="bait selector">
            <sub-events>
                <variable comment="button id of the trap that will receive the bait" constant="0" name="lastTrapClicked" sid="135495231081129" static="1" type="number">-1</variable>
                <event-block sid="218402869732595">
                    <conditions>
                        <condition id="0" name="On function" sid="253482013961532" type="Function">
                            <param id="0" name="Name">&quot;trap .clicked&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action disabled="1" id="14" name="Log" sid="486139223890224" type="Browser">
                            <param id="0" name="Type">0</param>
                            <param id="1" name="Message">&quot;pet&quot;</param>
                        </action>
                    </actions>
                    <sub-events>
                        <variable constant="0" name="clickedId" sid="447515627885014" static="0" type="number">-1</variable>
                        <event-block sid="684211172503399">
                            <conditions />
                            <actions>
                                <action id="-9" name="Set value" sid="335777185772412" type="System">
                                    <param id="0" name="Variable">clickedId</param>
                                    <param id="1" name="Value">Function.Param(0)</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="390660485571524">
                            <conditions />
                            <actions>
                                <action disabled="1" id="0" name="Call function" sid="330567983773637" type="Function">
                                    <param id="0" name="Name">&quot;traps .refillFood&quot;</param>
                                    <param id="1" name="Parameter {n}">3trap.id{###}choose(10, 30, 60){###}choose(&quot;normal&quot;, &quot;fancy&quot;)</param>
                                </action>
                                <action id="-9" name="Set value" sid="755390816136332" type="System">
                                    <param id="0" name="Variable">lastTrapClicked</param>
                                    <param id="1" name="Value">clickedId</param>
                                </action>
                                <action id="-4" name="Set layer visible" sid="669482870446028" type="System">
                                    <param id="0" name="Layer">&quot;bait selector&quot;</param>
                                    <param id="1" name="Visibility">1</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
                <comment>Update visuals</comment>
                <event-block sid="394487753729105">
                    <conditions>
                        <condition id="-9" name="Layer is visible" sid="981658119289163" type="System">
                            <param id="0" name="Layer">baitSelectorBtn.LayerNumber</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <comment>Fill text labels on buttons</comment>
                        <event-block sid="477800333207573">
                            <conditions>
                                <condition id="-8" name="Is boolean instance variable set" sid="959827258562412" type="3monsJSON">
                                    <param id="0" name="Instance variable">fullyLoaded</param>
                                </condition>
                                <condition id="-7" name="Compare instance variable" sid="178685625921709" type="baitSelectorTxt">
                                    <param id="0" name="Instance variable">which</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">&quot;button&quot;</param>
                                </condition>
                                <condition id="-4" name="Trigger once while true" sid="441621474598193" type="System" />
                            </conditions>
                            <actions />
                            <sub-events>
                                <event-block sid="201240437671188">
                                    <conditions>
                                        <condition id="-12" name="Repeat" sid="800862756388094" type="System">
                                            <param id="0" name="Count">3</param>
                                        </condition>
                                        <condition id="-7" name="Compare instance variable" sid="770803783920064" type="baitSelectorTxt">
                                            <param id="0" name="Instance variable">id</param>
                                            <param id="1" name="Comparison">0</param>
                                            <param id="2" name="Value">loopindex</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action disabled="1" id="14" name="Log" sid="395511061262306" type="Browser">
                                            <param id="0" name="Type">0</param>
                                            <param id="1" name="Message">loopindex</param>
                                        </action>
                                        <action id="-10" name="Set value" sid="766893067265036" type="baitSelectorTxt">
                                            <param id="0" name="Instance variable">theText</param>
                                            <param id="1" name="Value">Function.Call(&quot;shop .getBaitName&quot;, loopindex)</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-block>
                        <comment>Update bait counters</comment>
                        <event-block sid="726494162626412">
                            <conditions>
                                <condition id="-7" name="Compare instance variable" sid="502548065795961" type="baitSelectorTxt">
                                    <param id="0" name="Instance variable">which</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">&quot;amount&quot;</param>
                                </condition>
                                <condition id="-12" name="Repeat" sid="259637942914457" type="System">
                                    <param id="0" name="Count">3</param>
                                </condition>
                                <condition id="-7" name="Compare instance variable" sid="300848738235958" type="baitSelectorTxt">
                                    <param id="0" name="Instance variable">id</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">loopindex</param>
                                </condition>
                            </conditions>
                            <actions />
                            <sub-events>
                                <variable constant="0" name="quantity" sid="422940656797653" static="0" type="number">-1</variable>
                                <event-block sid="240877203545360">
                                    <conditions />
                                    <actions>
                                        <action id="-9" name="Set value" sid="389639677779766" type="System">
                                            <param id="0" name="Variable">quantity</param>
                                            <param id="1" name="Value">Function.Call(&quot;inventory .getQuantity&quot;, &quot;bait&quot;&amp;loopindex)</param>
                                        </action>
                                        <action id="-10" name="Set value" sid="471981934359070" type="baitSelectorTxt">
                                            <param id="0" name="Instance variable">theText</param>
                                            <param id="1" name="Value">quantity</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <event-block sid="468428563371641">
                                    <conditions>
                                        <condition id="-7" name="Compare instance variable" sid="728233896725048" type="baitSelectorBtn">
                                            <param id="0" name="Instance variable">buttonId</param>
                                            <param id="1" name="Comparison">0</param>
                                            <param id="2" name="Value">loopindex</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="-10" name="Set value" sid="695485978003227" type="baitSelectorBtn">
                                            <param id="0" name="Instance variable">state</param>
                                            <param id="1" name="Value">&quot;active&quot;</param>
                                        </action>
                                    </actions>
                                    <sub-events>
                                        <event-block sid="542805695198409">
                                            <conditions>
                                                <condition id="-14" name="Compare variable" sid="349357335364606" type="System">
                                                    <param id="0" name="Variable">quantity</param>
                                                    <param id="1" name="Comparison">3</param>
                                                    <param id="2" name="Value">0</param>
                                                </condition>
                                            </conditions>
                                            <actions>
                                                <action id="-10" name="Set value" sid="800232973695281" type="baitSelectorBtn">
                                                    <param id="0" name="Instance variable">state</param>
                                                    <param id="1" name="Value">&quot;disabled&quot;</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                    </sub-events>
                                </event-block>
                            </sub-events>
                        </event-block>
                    </sub-events>
                </event-block>
                <event-block sid="529831266308582">
                    <conditions>
                        <condition id="0" name="On function" sid="327325626615718" type="Function">
                            <param id="0" name="Name">&quot;baitSelector .close&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="-4" name="Set layer visible" sid="667416137370700" type="System">
                            <param id="0" name="Layer">&quot;bait selector&quot;</param>
                            <param id="1" name="Visibility">0</param>
                        </action>
                    </actions>
                </event-block>
                <event-block sid="465675220796442">
                    <conditions>
                        <condition id="0" name="On function" sid="426925544165168" type="Function">
                            <param id="0" name="Name">&quot;baitSelector .clickBait&quot;</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <variable constant="0" name="baitIndex" sid="493712381659318" static="0" type="number">-1</variable>
                        <event-block sid="376510871624554">
                            <conditions />
                            <actions>
                                <action id="-9" name="Set value" sid="219755383794854" type="System">
                                    <param id="0" name="Variable">baitIndex</param>
                                    <param id="1" name="Value">Function.Param(0)</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="349238530568936">
                            <conditions />
                            <actions>
                                <action id="0" name="Call function" sid="754575054006239" type="Function">
                                    <param id="0" name="Name">&quot;inventory .spend&quot;</param>
                                    <param id="1" name="Parameter {n}">&quot;bait&quot; &amp; baitIndex{###}1</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="870539626582289">
                            <conditions />
                            <actions>
                                <action id="0" name="Call function" sid="609066383753390" type="Function">
                                    <param id="0" name="Name">&quot;baitSelector .close&quot;</param>
                                    <param id="1" name="Parameter {n}"></param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
            </sub-events>
        </event-group>
        <event-group description="" sid="799838731313010" title="debug (traps)">
            <sub-events>
                <event-block sid="765528547089489">
                    <conditions>
                        <condition id="-18" name="Is in preview" sid="661579519558927" type="System" />
                    </conditions>
                    <actions />
                    <sub-events>
                        <event-block disabled="1" sid="332699366555795">
                            <conditions>
                                <condition id="-6" name="Every X seconds" sid="264565433427546" type="System">
                                    <param id="0" name="Interval (seconds)">1</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="14" name="Log" sid="698703762127055" type="Browser">
                                    <param id="0" name="Type">0</param>
                                    <param id="1" name="Message">&quot;before&quot;</param>
                                </action>
                                <action disabled="1" id="0" name="Call function" sid="593521751542346" type="Function">
                                    <param id="0" name="Name">&quot;dex .initiateDex&quot;</param>
                                    <param id="1" name="Parameter {n}"></param>
                                </action>
                                <action id="14" name="Log" sid="670885946401365" type="Browser">
                                    <param id="0" name="Type">0</param>
                                    <param id="1" name="Message">&quot;after&quot;</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
            </sub-events>
        </event-group>
    </events>
</c2eventsheet>
