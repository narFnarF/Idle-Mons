<?xml version="1.0" encoding="utf-8" ?>
<c2eventsheet>
    <!--All the 'name' attributes are ignored by Construct 2 - they are there for readability only.-->
    <name>eMonsJSON</name>
    <events>
        <include>eDexJSON</include>
        <event-group description="" sid="559641465357570" title="AJAX request (mons.json)">
            <sub-events>
                <comment>Request the json once per day (it also triggers on the first start, for a New Game)</comment>
                <event-block sid="353587388221620">
                    <conditions>
                        <condition id="1" name="Is online" sid="358585779743503" type="Browser" />
                        <condition id="-7" inverted="1" name="Compare instance variable" sid="778920771613644" type="3monsJSON">
                            <param id="0" name="Instance variable">date</param>
                            <param id="1" name="Comparison">0</param>
                            <param id="2" name="Value">date.Date</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="1" name="Request project file" sid="179850598389900" type="AJAX">
                            <param id="0" name="Tag">&quot;mons.json&quot;</param>
                            <param id="1" name="File">mons.json</param>
                        </action>
                        <action id="-10" name="Set value" sid="360854307410305" type="3monsJSON">
                            <param id="0" name="Instance variable">date</param>
                            <param id="1" name="Value">Date.Date</param>
                        </action>
                    </actions>
                </event-block>
                <comment>if the internet was down the first time you launched the game and the array is still empty, this will make sure you&apos;re quickly back on track by trying every 15 sec</comment>
                <event-block sid="106672379521351">
                    <conditions>
                        <condition id="70" name="Is Empty" sid="708085315007437" type="3monsJSON">
                            <param id="0" name="Reference point">0</param>
                            <param id="1" name="Key {n}"></param>
                        </condition>
                        <condition id="1" name="Is online" sid="262633634586110" type="Browser" />
                        <condition id="-6" name="Every X seconds" sid="483984020912747" type="System">
                            <param id="0" name="Interval (seconds)">15</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="14" name="Log" sid="924001208575954" type="Browser">
                            <param id="0" name="Type">0</param>
                            <param id="1" name="Message">&quot;Trying to get again the traps JSON&quot;</param>
                        </action>
                        <action id="1" name="Request project file" sid="713218814779843" type="AJAX">
                            <param id="0" name="Tag">&quot;mons.json&quot;</param>
                            <param id="1" name="File">mons.json</param>
                        </action>
                    </actions>
                </event-block>
                <event-block sid="532419638753226">
                    <conditions>
                        <condition id="0" name="On completed" sid="322087223870364" type="AJAX">
                            <param id="0" name="Tag">&quot;mons.json&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="60" name="LoadJSON" sid="429544765197060" type="3monsJSON">
                            <param id="0" name="JSON">AJAX.LastData</param>
                            <param id="1" name="Reference point">0</param>
                            <param id="2" name="Key {n}"></param>
                        </action>
                        <action id="0" name="Call function" sid="415176917777710" type="Function">
                            <param id="0" name="Name">&quot;dex .initiateDex&quot;</param>
                            <param id="1" name="Parameter {n}"></param>
                        </action>
                        <action id="-13" name="Set boolean" sid="158731153682540" type="3monsJSON">
                            <param id="0" name="Instance variable">fullyLoaded</param>
                            <param id="1" name="Value">1</param>
                        </action>
                    </actions>
                </event-block>
                <event-block sid="895380455501266">
                    <conditions>
                        <condition id="1" name="On error" sid="296132172079394" type="AJAX">
                            <param id="0" name="Tag">&quot;mons.json&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="14" name="Log" sid="201952118280992" type="Browser">
                            <param id="0" name="Type">1</param>
                            <param id="1" name="Message">&quot;Tried to retrieve mons.json but couldn&apos;t. Probably because internet connection is missing. Will try again later.&quot;</param>
                        </action>
                    </actions>
                </event-block>
                <event-block sid="411431548521860">
                    <conditions>
                        <condition id="200" name="On JSON Parse Error" sid="444676574145155" type="3monsJSON" />
                    </conditions>
                    <actions>
                        <action id="14" name="Log" sid="732927643711785" type="Browser">
                            <param id="0" name="Type">1</param>
                            <param id="1" name="Message">&quot;The mons.json is not formated properly.&quot;</param>
                        </action>
                    </actions>
                </event-block>
            </sub-events>
        </event-group>
        <event-group description="" sid="774611380578229" title="mons function">
            <sub-events>
                <event-block sid="315454221851938">
                    <conditions>
                        <condition id="0" name="On function" sid="235934790610036" type="Function">
                            <param id="0" name="Name">&quot;mons .count&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action disabled="1" id="14" name="Log" sid="836291135775936" type="Browser">
                            <param id="0" name="Type">0</param>
                            <param id="1" name="Message">&quot;function mons.count&quot;</param>
                        </action>
                    </actions>
                    <sub-events>
                        <event-block sid="430065322211689">
                            <conditions>
                                <condition id="-8" name="Is boolean instance variable set" sid="526568336719465" type="3monsJSON">
                                    <param id="0" name="Instance variable">fullyLoaded</param>
                                </condition>
                            </conditions>
                            <actions />
                            <sub-events>
                                <event-block sid="533939913719822">
                                    <conditions>
                                        <condition id="60" inverted="1" name="Is undefined" sid="451399704360793" type="3monsJSON">
                                            <param id="0" name="Reference point">0</param>
                                            <param id="1" name="Key {n}">&quot;mons&quot;</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="1" name="Set return value" sid="325371965940684" type="Function">
                                            <param id="0" name="Value">3monsJSON.Size(0, &quot;mons&quot;)</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <event-block sid="855572368963479">
                                    <conditions>
                                        <condition id="-22" name="Else" sid="356422034945130" type="System" />
                                    </conditions>
                                    <actions>
                                        <action id="14" name="Log" sid="380722483072694" type="Browser">
                                            <param id="0" name="Type">1</param>
                                            <param id="1" name="Message">&quot;Error from mons.count: The JSON don&apos;t contain a mons node.&quot;</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-block>
                        <event-block sid="269409198504132">
                            <conditions>
                                <condition id="-22" name="Else" sid="889932534275644" type="System" />
                            </conditions>
                            <actions>
                                <action id="14" name="Log" sid="462047393365487" type="Browser">
                                    <param id="0" name="Type">1</param>
                                    <param id="1" name="Message">&quot;Error from mons.count: Trying to access the JSON which is not yet loaded.&quot;</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
                <event-block sid="779863278442747">
                    <conditions>
                        <condition id="0" name="On function" sid="499023167042027" type="Function">
                            <param id="0" name="Name">&quot;mons .name&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action disabled="1" id="14" name="Log" sid="729023759744322" type="Browser">
                            <param id="0" name="Type">0</param>
                            <param id="1" name="Message">&quot;function mons.name&quot;</param>
                        </action>
                    </actions>
                    <sub-events>
                        <variable constant="0" name="id" sid="287982594440250" static="0" type="number">0</variable>
                        <event-block sid="818852288899814">
                            <conditions />
                            <actions>
                                <action id="-9" name="Set value" sid="161675725810889" type="System">
                                    <param id="0" name="Variable">id</param>
                                    <param id="1" name="Value">Function.Param(0)</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="497438105464808">
                            <conditions>
                                <condition id="-8" name="Is boolean instance variable set" sid="431226848132906" type="3monsJSON">
                                    <param id="0" name="Instance variable">fullyLoaded</param>
                                </condition>
                            </conditions>
                            <actions />
                            <sub-events>
                                <event-block sid="450514119913050">
                                    <conditions>
                                        <condition id="-14" name="Compare variable" sid="911551505605742" type="System">
                                            <param id="0" name="Variable">id</param>
                                            <param id="1" name="Comparison">5</param>
                                            <param id="2" name="Value">0</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="1" name="Set return value" sid="917095018715515" type="Function">
                                            <param id="0" name="Value">3monsJSON.Value(0, &quot;mons&quot;, id, &quot;name&quot;)</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <event-block sid="887249519324757">
                                    <conditions>
                                        <condition id="-22" name="Else" sid="732068283582448" type="System" />
                                    </conditions>
                                    <actions>
                                        <action id="14" name="Log" sid="308966402349643" type="Browser">
                                            <param id="0" name="Type">1</param>
                                            <param id="1" name="Message">&quot;Error from mons.name: Trying to access &lt;0&quot;</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-block>
                        <event-block sid="756051000794876">
                            <conditions>
                                <condition id="-22" name="Else" sid="739122741629200" type="System" />
                            </conditions>
                            <actions>
                                <action id="14" name="Log" sid="652811099888395" type="Browser">
                                    <param id="0" name="Type">1</param>
                                    <param id="1" name="Message">&quot;Error from mons.name: Trying to access the JSON which is not yet loaded.&quot;</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
                <event-block sid="128775819446817">
                    <conditions>
                        <condition id="0" name="On function" sid="527917691628465" type="Function">
                            <param id="0" name="Name">&quot;mons .duration&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action disabled="1" id="14" name="Log" sid="155720174116154" type="Browser">
                            <param id="0" name="Type">0</param>
                            <param id="1" name="Message">&quot;function mons.duration&quot;</param>
                        </action>
                    </actions>
                    <sub-events>
                        <variable constant="0" name="id" sid="995771008687952" static="0" type="number">0</variable>
                        <event-block sid="642920890496521">
                            <conditions />
                            <actions>
                                <action id="-9" name="Set value" sid="858035320381720" type="System">
                                    <param id="0" name="Variable">id</param>
                                    <param id="1" name="Value">Function.Param(0)</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="919539272537151">
                            <conditions>
                                <condition id="-14" name="Compare variable" sid="328232417797392" type="System">
                                    <param id="0" name="Variable">id</param>
                                    <param id="1" name="Comparison">5</param>
                                    <param id="2" name="Value">0</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="1" name="Set return value" sid="758326794617948" type="Function">
                                    <param id="0" name="Value">3monsJSON.Value(0, &quot;mons&quot;, id, &quot;duration&quot;)</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="997482772190112">
                            <conditions>
                                <condition id="-22" name="Else" sid="158941075406765" type="System" />
                            </conditions>
                            <actions>
                                <action id="14" name="Log" sid="490196580532365" type="Browser">
                                    <param id="0" name="Type">1</param>
                                    <param id="1" name="Message">&quot;Error from mons.duration: Trying to access &lt;0&quot;</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
                <event-block sid="429947112066477">
                    <conditions>
                        <condition id="0" name="On function" sid="743336900586332" type="Function">
                            <param id="0" name="Name">&quot;mons .gift&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action disabled="1" id="14" name="Log" sid="808122527527103" type="Browser">
                            <param id="0" name="Type">0</param>
                            <param id="1" name="Message">&quot;function mons.gift&quot;</param>
                        </action>
                    </actions>
                    <sub-events>
                        <variable constant="0" name="id" sid="805602171810369" static="0" type="number">0</variable>
                        <event-block sid="522927953526963">
                            <conditions />
                            <actions>
                                <action id="-9" name="Set value" sid="865155223192797" type="System">
                                    <param id="0" name="Variable">id</param>
                                    <param id="1" name="Value">Function.Param(0)</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="200104175665877">
                            <conditions>
                                <condition id="-14" name="Compare variable" sid="510150766935951" type="System">
                                    <param id="0" name="Variable">id</param>
                                    <param id="1" name="Comparison">5</param>
                                    <param id="2" name="Value">0</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="1" name="Set return value" sid="622211621055718" type="Function">
                                    <param id="0" name="Value">3monsJSON.Value(0, &quot;mons&quot;, id, &quot;gift&quot;)</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="259419682100228">
                            <conditions>
                                <condition id="-22" name="Else" sid="356589400764673" type="System" />
                            </conditions>
                            <actions>
                                <action id="14" name="Log" sid="803572716115064" type="Browser">
                                    <param id="0" name="Type">1</param>
                                    <param id="1" name="Message">&quot;Error from mons.gift: Trying to access &lt;0&quot;</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
            </sub-events>
        </event-group>
        <event-group description="" sid="350458092138267" title="shop functions">
            <sub-events>
                <event-block sid="595926452503371">
                    <conditions>
                        <condition id="0" name="On function" sid="332195353827654" type="Function">
                            <param id="0" name="Name">&quot;shop .getBaitName&quot;</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <variable comment="the index of the bait in the json" constant="0" name="baitIndex" sid="131338431457707" static="0" type="number">-1</variable>
                        <event-block sid="459303111195987">
                            <conditions />
                            <actions>
                                <action id="-9" name="Set value" sid="462539717691897" type="System">
                                    <param id="0" name="Variable">baitIndex</param>
                                    <param id="1" name="Value">Function.Param(0)</param>
                                </action>
                            </actions>
                        </event-block>
                        <comment>TODO: Add security here, if the function tries to call a bait that doesn&apos;t exist, so that it doesn&apos;t pollute the browser log.</comment>
                        <event-block sid="742359007273462">
                            <conditions>
                                <condition id="-8" name="Is boolean instance variable set" sid="839687478890578" type="3monsJSON">
                                    <param id="0" name="Instance variable">fullyLoaded</param>
                                </condition>
                            </conditions>
                            <actions />
                            <sub-events>
                                <event-block sid="113815902654508">
                                    <conditions>
                                        <condition id="60" inverted="1" name="Is undefined" sid="639170730672225" type="3monsJSON">
                                            <param id="0" name="Reference point">0</param>
                                            <param id="1" name="Key {n}">&quot;bait&quot;{###}baitIndex{###}&quot;name&quot;</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="1" name="Set return value" sid="680026643842119" type="Function">
                                            <param id="0" name="Value">3monsJSON.Value(0, &quot;bait&quot;, baitIndex, &quot;name&quot;)</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <event-block sid="563282013753011">
                                    <conditions>
                                        <condition id="-22" name="Else" sid="999413779338982" type="System" />
                                    </conditions>
                                    <actions>
                                        <action id="14" name="Log" sid="171072163088194" type="Browser">
                                            <param id="0" name="Type">1</param>
                                            <param id="1" name="Message">&quot;Trying to reach an undefined node in shop .getBaitName : &quot; &amp; baitIndex</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-block>
                        <event-block sid="689159381168664">
                            <conditions>
                                <condition id="-22" name="Else" sid="558946409377167" type="System" />
                            </conditions>
                            <actions>
                                <action id="14" name="Log" sid="153282972964997" type="Browser">
                                    <param id="0" name="Type">1</param>
                                    <param id="1" name="Message">&quot;Error from shop.getBaitName: Trying to access the JSON which is not yet loaded.&quot;</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
                <event-block sid="756637415931428">
                    <conditions>
                        <condition id="0" name="On function" sid="318947028276299" type="Function">
                            <param id="0" name="Name">&quot;shop .getBaitCost&quot;</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <variable constant="0" name="baitIndex" sid="333297904402748" static="0" type="number">-1</variable>
                        <event-block sid="178326497146000">
                            <conditions />
                            <actions>
                                <action id="-9" name="Set value" sid="413344868412810" type="System">
                                    <param id="0" name="Variable">baitIndex</param>
                                    <param id="1" name="Value">Function.Param(0)</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="250127952228935">
                            <conditions>
                                <condition id="60" inverted="1" name="Is undefined" sid="278937800732929" type="3monsJSON">
                                    <param id="0" name="Reference point">0</param>
                                    <param id="1" name="Key {n}">&quot;bait&quot;{###}baitIndex{###}&quot;cost&quot;</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="1" name="Set return value" sid="258361036139218" type="Function">
                                    <param id="0" name="Value">3monsJSON.Value(0, &quot;bait&quot;, baitIndex, &quot;cost&quot;)</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="361256752317416">
                            <conditions>
                                <condition id="-22" name="Else" sid="311185151942910" type="System" />
                            </conditions>
                            <actions>
                                <action id="14" name="Log" sid="732108900357982" type="Browser">
                                    <param id="0" name="Type">1</param>
                                    <param id="1" name="Message">&quot;Trying to reach an undefined node in shop .getBaitCost : &quot; &amp; baitIndex</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
                <event-block sid="536719245758514">
                    <conditions>
                        <condition id="0" name="On function" sid="921191982680091" type="Function">
                            <param id="0" name="Name">&quot;shop .getBaitDuration&quot;</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <variable constant="0" name="baitIndex" sid="618721412565846" static="0" type="number">-1</variable>
                        <event-block sid="905135823975571">
                            <conditions />
                            <actions>
                                <action id="-9" name="Set value" sid="902145566599362" type="System">
                                    <param id="0" name="Variable">baitIndex</param>
                                    <param id="1" name="Value">Function.Param(0)</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="987379135325142">
                            <conditions>
                                <condition id="60" inverted="1" name="Is undefined" sid="839946242329458" type="3monsJSON">
                                    <param id="0" name="Reference point">0</param>
                                    <param id="1" name="Key {n}">&quot;bait&quot;{###}baitIndex{###}&quot;duration&quot;</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="1" name="Set return value" sid="292633019210034" type="Function">
                                    <param id="0" name="Value">3monsJSON.Value(0, &quot;bait&quot;, baitIndex, &quot;duration&quot;)</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="186550680670614">
                            <conditions>
                                <condition id="-22" name="Else" sid="973639387253777" type="System" />
                            </conditions>
                            <actions>
                                <action id="14" name="Log" sid="148680063753680" type="Browser">
                                    <param id="0" name="Type">1</param>
                                    <param id="1" name="Message">&quot;Trying to reach an undefined node in shop .getBaitDuration : &quot; &amp; baitIndex</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
            </sub-events>
        </event-group>
        <event-group description="" sid="745819940776691" title="debug (mons.json)">
            <sub-events>
                <event-block sid="830324351519742">
                    <conditions>
                        <condition id="-18" name="Is in preview" sid="626982103027155" type="System" />
                    </conditions>
                    <actions />
                    <sub-events>
                        <event-block sid="729570135923569">
                            <conditions>
                                <condition id="-6" name="Every X seconds" sid="199670017431012" type="System">
                                    <param id="0" name="Interval (seconds)">1</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action disabled="1" id="14" name="Log" sid="579306133422179" type="Browser">
                                    <param id="0" name="Type">0</param>
                                    <param id="1" name="Message">&quot;before: &quot; &amp; Function.Call(&quot;dex .isMet&quot;, 1)</param>
                                </action>
                                <action disabled="1" id="0" name="Call function" sid="651796085968194" type="Function">
                                    <param id="0" name="Name">&quot;dex .addMet&quot;</param>
                                    <param id="1" name="Parameter {n}">1</param>
                                </action>
                                <action disabled="1" id="14" name="Log" sid="982808968182699" type="Browser">
                                    <param id="0" name="Type">0</param>
                                    <param id="1" name="Message">&quot;before: &quot; &amp; Function.Call(&quot;dex .isMet&quot;, 1)</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
            </sub-events>
        </event-group>
    </events>
</c2eventsheet>
